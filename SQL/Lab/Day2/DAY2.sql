DROP TABLE EMP;
DROP TABLE DEPT;
DROP TABLE SALGRADE;

CREATE TABLE DEPT 
(
    DEPTNO NUMBER(2) PRIMARY KEY,
    DNAME  VARCHAR2(14),
    LOC    VARCHAR2(13)
);

INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT VALUES (20, 'RESEARCH',   'DALLAS');
INSERT INTO DEPT VALUES (30, 'SALES',      'CHICAGO');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');


CREATE TABLE EMP 
(
    EMPNO    NUMBER(4) PRIMARY KEY,
    ENAME    VARCHAR2(10),
    JOB      VARCHAR2(9),
    MGR      NUMBER(4),
    HIREDATE DATE,
    SAL      NUMBER(7,2),
    COMM     NUMBER(7,2),
    DEPTNO   NUMBER(2),
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
);

INSERT INTO EMP VALUES
        (7369, 'SMITH','CLERK',7902,
        TO_DATE('17-DEC-1980', 'DD-MON-YYYY'),  800, NULL, 20);

INSERT INTO EMP VALUES
        (7499, 'ALLEN',  'SALESMAN',  7698,
        TO_DATE('20-FEB-1981', 'DD-MON-YYYY'), 1600,  300, 30);

INSERT INTO EMP VALUES
        (7521, 'WARD',   'SALESMAN',  7698,
        TO_DATE('22-FEB-1981', 'DD-MON-YYYY'), 1250,  500, 30);

INSERT INTO EMP VALUES
        (7566, 'JONES',  'MANAGER',   7839,
        TO_DATE('2-APR-1981', 'DD-MON-YYYY'),  2975, NULL, 20);

INSERT INTO EMP VALUES
        (7654, 'MARTIN', 'SALESMAN',  7698,
        TO_DATE('28-SEP-1981', 'DD-MON-YYYY'), 1250, 1400, 30);

INSERT INTO EMP VALUES
        (7698, 'BLAKE',  'MANAGER',   7839,
        TO_DATE('1-MAY-1981', 'DD-MON-YYYY'),  2850, NULL, 30);

INSERT INTO EMP VALUES
        (7782, 'CLARK',  'MANAGER',   7839,
        TO_DATE('9-JUN-1981', 'DD-MON-YYYY'),  2450, NULL, 10);

INSERT INTO EMP VALUES
        (7788, 'SCOTT',  'ANALYST',   7566,
        TO_DATE('09-DEC-1982', 'DD-MON-YYYY'), 3000, NULL, 20);

INSERT INTO EMP VALUES
        (7839, 'KING',   'PRESIDENT', NULL,
        TO_DATE('17-NOV-1981', 'DD-MON-YYYY'), 5000, NULL, 10);

INSERT INTO EMP VALUES
        (7844, 'TURNER', 'SALESMAN',  7698,
        TO_DATE('8-SEP-1981', 'DD-MON-YYYY'),  1500, 0, 30);

INSERT INTO EMP VALUES
        (7876, 'ADAMS',  'CLERK',     7788,
        TO_DATE('12-JAN-1983', 'DD-MON-YYYY'), 1100, NULL, 20);

INSERT INTO EMP VALUES
        (7900, 'JAMES',  'CLERK',     7698,
        TO_DATE('3-DEC-1981', 'DD-MON-YYYY'),   950, NULL, 30);

INSERT INTO EMP VALUES
        (7902, 'FORD',   'ANALYST',   7566,
        TO_DATE('3-DEC-1981', 'DD-MON-YYYY'),  3000, NULL, 20);

INSERT INTO EMP VALUES
        (7934, 'MILLER', 'CLERK',     7782,
        TO_DATE('23-JAN-1982', 'DD-MON-YYYY'), 1300, NULL, 10);

CREATE TABLE SALGRADE
        (GRADE NUMBER,
         LOSAL NUMBER,
         HISAL NUMBER);

INSERT INTO SALGRADE VALUES (1,  700, 1200);
INSERT INTO SALGRADE VALUES (2, 1201, 1400);
INSERT INTO SALGRADE VALUES (3, 1401, 2000);
INSERT INTO SALGRADE VALUES (4, 2001, 3000);
INSERT INTO SALGRADE VALUES (5, 3001, 9999);

COMMIT;

-- 1 QUESTION
SELECT * FROM EMP WHERE JOB = 'MANAGER';


--2
SELECT * FROM EMP WHERE SAL = 3000;

--3
SELECT * FROM EMP WHERE SAL >2000;

--4
SELECT * FROM EMP WHERE SAL >= 3000;

--5
SELECT * FROM EMP WHERE DEPTNO = 10;

--6
SELECT * FROM EMP WHERE ENAME = 'SMITH';

--7
SELECT * FROM EMP WHERE JOB = 'CLERK';


--TABLE


CREATE TABLE CUSTOMER123 
(
CUSTOMER_ID  NUMBER(10),
NAME VARCHAR2(10),
GENDER VARCHAR2(10),
PHONE VARCHAR2(10),
EMAIL VARCHAR2(20),
DISTRICT VARCHAR2(10),
STATE VARCHAR2(10)
);


INSERT INTO CUSTOMER123 VALUES(201,'SURYA','M','9876543210','surya@gmail.com','Kolar','Karnataka');

INSERT INTO CUSTOMER123 VALUES(202, 'ANUSHKA','F', '9123456780', 'anushka@gmail.com','Kolar','Karnataka');

INSERT INTO CUSTOMER123 VALUES(203, 'GOWTHAM','M', '9988776655','gowtham@gmail.com', 'Kolar', 'Karnataka');

INSERT INTO CUSTOMER123 VALUES(204,'PRIYA','F','9012345678','priya@gmail.com', 'Bangalore','Karnataka');

INSERT INTO CUSTOMER123 VALUES(205,'KIRAN','M','9001122334','kiran@gmail.com','Kolar','Karnataka');

INSERT INTO CUSTOMER123 VALUES(206,'KAVYA','F','9345678901','kavya@gmail.com','Mysore','Karnataka');

COMMIT;

--8
SELECT CUSTOMER_ID,NAME,GENDER,PHONE FROM CUSTOMER123 WHERE DISTRICT = 'Kolar';

--9
SELECT * FROM EMP;
SELECT * FROM EMP WHERE HIREDATE = '17 December 1980';

--10
SELECT * FROM EMP WHERE HIREDATE > '31 DECEMBER 1981';

--11
SELECT * FROM EMP WHERE HIREDATE < '31 DECEMBER 1981';

--12
SELECT * FROM EMP WHERE SAL*12 > 30000;

--LOGICAL OPERATORS
--1
SELECT * FROM EMP WHERE JOB = 'CLERK' AND SAL > 1000;

--2
SELECT * FROM EMP WHERE JOB = 'CLERK' AND DEPTNO = 20;

--3
SELECT * FROM EMP WHERE JOB = 'CLERK' OR JOB='SALESMAN' OR JOB='MANAGER';

--4
SELECT * FROM EMP WHERE DEPTNO = 20 OR DEPTNO = 30 OR DEPTNO = 50 OR DEPTNO = 70 OR DEPTNO = 90;

--5
SELECT * FROM EMP WHERE SAL BETWEEN 2450 AND 3000;

--6
SELECT * FROM EMP WHERE HIREDATE BETWEEN '1 JANUARY 1981' AND '31 DECEMBER 1981';

--7

CREATE TABLE STUDENT1(SNO NUMBER, SNAME VARCHAR(20), SUB1 NUMBER, SUB2 NUMBER, SUB3 NUMBER);

INSERT INTO STUDENT1 VALUES (1, 'GOWTHAM', 72 ,18,24);
INSERT INTO STUDENT1 VALUES (1, 'KAVYA', 60 ,50,45);
UPDATE STUDENT1 SET SNO = 2 WHERE SNO = 1 AND SNAME = 'KAVYA';

INSERT INTO STUDENT1 VALUES (3, 'PREEETHI', 12,30,25);

SELECT * FROM STUDENT1;
DELETE FROM STUDENT1 WHERE ROWID NOT IN(SELECT MIN(ROWID) FROM STUDENT1 GROUP BY SNAME);
SELECT * FROM STUDENT1;
INSERT INTO STUDENT1 VALUES (4, 'PRIYA', 80,90,85);
SELECT * FROM STUDENT1;

COMMIT;
--8
SELECT * FROM STUDENT1 WHERE SUB1 < 35 AND SUB2 < 35 AND SUB3 < 35;
--9
SELECT * FROM STUDENT1 WHERE SUB1 > 35 OR SUB2 > 35 OR SUB3 > 35;


--Practice on IN
--1️⃣ Write a query to display employees who belong to department 10, 20, and 30.
SELECT * FROM EMP WHERE DEPTNO IN (10,30);


--Write a query to display employees whose job is CLERK or MANAGER or ANALYST.
SELECT * FROM EMP WHERE JOB IN ('CLERK' , 'MANAGER', 'ANALYST');

--Write an SQL query to display employees who are not working in departments 10 and 20.
SELECT * FROM EMP WHERE DEPTNO NOT IN (20);

--Write an SQL query to display employees who joined on 17-DEC-1980, 20-FEB-1981, or 22-FEB-1981.
SELECT * FROM EMP WHERE HIREDATE IN ('17-DECEMBER-1980' , '20-FEB-1981','22-FEB-1981');

SELECT * FROM EMP;

show recyclebin;
PURGE RECYCLEBIN;

show recyclebin;